<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Australian Tourism Visualizations</title>
  <!-- Include Vega, Vega-Lite, and Vega-Embed via CDN -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .viz-container {
      margin-bottom: 50px;
    }
    .viz-title {
      text-align: center;
      margin-bottom: 10px;
      font-size: 24px;
      color: #333;
    }
    /* Responsive Layout: Stacked on small screens, side by side on larger screens */
    @media (min-width: 1000px) {
      .visualizations {
        display: flex;
        justify-content: space-between;
      }
      .viz-container {
        width: 48%;
      }
    }
  </style>
</head>
<body>
  <h1>Australian Tourism Dashboard</h1>
  
  <div class="visualizations">
    <!-- Visualization 1: Map of Short-term Visitor Arrivals by Australian States -->
    <div class="viz-container">
      <div class="viz-title">Short-term Visitor Arrivals by Australian States (July 2024)</div>
      <div id="map"></div>
      <script type="text/javascript">
        const mapSpec = {
          "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
          "width": 700,
          "height": 500,
          "title": "Short-term Visitor Arrivals by Australian States (July 2024)",
          "data": {
            "url": "https://raw.githubusercontent.com/SlayerPuppets/FIT3179/main/Week%209%20Homework/data/georef-australia-state@public.topojson",
            "format": {
              "type": "topojson",
              "feature": "georef-australia-state@public"
            }
          },
          "transform": [
            {
              "lookup": "properties.ste_name",
              "from": {
                "data": {
                  "url": "https://raw.githubusercontent.com/SlayerPuppets/FIT3179/main/Week%209%20Homework/data/tourist_by_state.csv"
                },
                "key": "Region",
                "fields": ["Number of visitor arrivals"]
              }
            }
          ],
          "projection": {
            "type": "mercator"
          },
          "mark": {
            "type": "geoshape",
            "stroke": "black",
            "strokeWidth": 0.5
          },
          "encoding": {
            "color": {
              "field": "Number of visitor arrivals",
              "type": "quantitative",
              "scale": {
                "domain": [0, 50000, 100000, 150000, 200000, 250000],
                "range": ["#f7fbff", "#c6dbef", "#6baed6", "#2171b5", "#08306b"]
              },
              "legend": {
                "title": "Visitor Arrivals"
              }
            },
            "tooltip": [
              {"field": "properties.ste_name", "type": "nominal", "title": "State or Territory"},
              {"field": "Number of visitor arrivals", "type": "quantitative", "title": "Visitor Arrivals"}
            ]
          }
        };
        
        // Embed the map visualization
        vegaEmbed('#map', mapSpec).then(result => {
          // Access the Vega view instance (optional)
          // const view = result.view;
        }).catch(error => {
          console.error(error);
        });
      </script>
    </div>
    
    <!-- Visualization 2: Number of Tourists per Country with Year Filter -->
    <div class="viz-container">
      <div class="viz-title">Number of Tourists per Country (Selected Year)</div>
      <div id="bar-chart"></div>
      <script type="text/javascript">
        const barChartSpec = {
          "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
          "title": {
            "text": "Number of Tourists per Country (Selected Year)",
            "subtitle": "Data Source: Australian Tourism Statistics",
            "fontSize": 20,
            "subtitleFontSize": 14,
            "anchor": "start",
            "font": "Helvetica Neue, Arial",
            "color": "#333"
          },
          "description": "Vertical bar chart showing the number of tourists per country with a year filter, including an average line annotation.",
          "data": {
            "url": "https://raw.githubusercontent.com/SlayerPuppets/FIT3179/main/Week%2010%20Homework/data/2.2%20Short-term%20visitor%20arrivals,%20Australia%20-%20top%2010%20source%20countries(a).csv",
            "format": {
              "type": "csv"
            }
          },
          "transform": [
            {
              "fold": ["Jul-19", "Jul-22", "Jul-23", "Jul-24"],
              "as": ["Year", "Tourists"]
            },
            {
              "calculate": "datum.Tourists != null ? parseFloat(replace(datum.Tourists, ',', '')) : 0",
              "as": "Tourists"
            },
            {
              "filter": "datum.Year === selected_year"
            }
          ],
          "width": 800,
          "height": 500,
          "layer": [
            {
              "mark": "bar",
              "encoding": {
                "x": {
                  "field": "Country of Residence",
                  "type": "nominal",
                  "axis": {
                    "title": "Country of Residence",
                    "labelAngle": -45
                  }
                },
                "y": {
                  "field": "Tourists",
                  "type": "quantitative",
                  "axis": {
                    "title": "Number of Tourists"
                  }
                },
                "color": {
                  "field": "Country of Residence",
                  "type": "nominal",
                  "legend": null
                },
                "tooltip": [
                  {"field": "Country of Residence", "type": "nominal", "title": "Country"},
                  {"field": "Year", "type": "nominal", "title": "Year"},
                  {"field": "Tourists", "type": "quantitative", "title": "Number of Tourists"}
                ]
              }
            },
            {
              "transform": [
                {
                  "aggregate": [
                    {
                      "op": "mean",
                      "field": "Tourists",
                      "as": "Average_Tourists"
                    }
                  ]
                }
              ],
              "mark": {
                "type": "rule",
                "color": "red",
                "strokeWidth": 2
              },
              "encoding": {
                "y": {
                  "field": "Average_Tourists",
                  "type": "quantitative"
                },
                "tooltip": [
                  {"field": "Average_Tourists", "type": "quantitative", "title": "Average Tourists"}
                ]
              }
            },
            {
              "transform": [
                {
                  "aggregate": [
                    {
                      "op": "mean",
                      "field": "Tourists",
                      "as": "Average_Tourists"
                    }
                  ]
                }
              ],
              "mark": {
                "type": "text",
                "align": "left",
                "dx": 5,
                "dy": -5,
                "color": "red",
                "fontSize": 12
              },
              "encoding": {
                "y": {
                  "field": "Average_Tourists",
                  "type": "quantitative"
                },
                "text": {
                  "value": "Average"
                }
              }
            }
          ],
          "params": [
            {
              "name": "selected_year",
              "bind": {
                "input": "select",
                "options": ["Jul-19", "Jul-22", "Jul-23", "Jul-24"],
                "name": "Select Year: "
              },
              "value": "Jul-19"
            }
          ]
        };
        
        // Embed the bar chart visualization
        vegaEmbed('#bar-chart', barChartSpec).then(result => {
          // Access the Vega view instance (optional)
          // const view = result.view;
        }).catch(error => {
          console.error(error);
        });
      </script>
    </div>
  </div>
</body>
</html>
